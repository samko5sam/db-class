{% extends "base.html" %} {% block content %}
<div class="container">
  <h1>Today's Recommended Joke</h1>

  <div id="joke-container">
    {% for joke in initial_jokes %}
    <div class="joke-card">
      <p style="white-space: pre-wrap">{{ joke.content }}</p>
      <small
        >- Posted by
        <a
          class="author-link"
          href="{{ url_for('user_jokes', username=joke.author_username) }}"
          >{{ joke.author_username }}</a
        ></small
      >

      {% if current_user.is_authenticated and current_user.username ==
      joke.author_username %}
      <div class="joke-controls">
        <a href="{{ url_for('edit_joke', joke_id=joke._id) }}" class="edit-link"
          >Edit</a
        >
        <form
          action="{{ url_for('delete_joke', joke_id=joke._id) }}"
          method="POST"
          onsubmit="return confirm('Are you sure you want to delete this joke?');"
        >
          <button type="submit" class="delete-button">Delete</button>
        </form>
      </div>
      {% endif %}
    </div>
    {% else %}
    <p>
      No jokes found! Be the first to
      <a href="{{ url_for('post_joke') }}">post one</a>.
    </p>
    {% endfor %}
  </div>

  <!-- This will be shown while new jokes are loading -->
  <div id="loading" class="loading-indicator" style="display: none">
    <p>Fetching another hilarious joke...</p>
  </div>
</div>
{% endblock %}
