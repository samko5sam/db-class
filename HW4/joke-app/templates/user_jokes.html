{% extends "base.html" %} {% block content %}
<div class="container">
  <h1>Jokes by {{ username }}</h1>

  {% if current_user.is_authenticated and current_user.username == username %}
  <div class="page-actions" style="text-align: right; margin-bottom: 1.5rem;">
    <a href="{{ url_for('manage_jokes') }}" class="button-link">Manage My Jokes</a>
  </div>
  {% endif %}

  <div class="joke-list-container">
    {% if jokes %} {% for joke in jokes %}
    <div class="joke-card">
      <p style="white-space: pre-wrap">{{ joke.content }}</p>
      <!-- We don't need to link the author's name here since we're on their page -->
      <small>- Posted by {{ joke.author_username }}</small>

      <!-- Conditionally show edit/delete controls -->
      {% if current_user.is_authenticated and current_user.username ==
      joke.author_username %}
      <div class="joke-controls">
        <a href="{{ url_for('edit_joke', joke_id=joke._id) }}" class="edit-link"
          >Edit</a
        >
        <form
          action="{{ url_for('delete_joke', joke_id=joke._id) }}"
          method="POST"
          onsubmit="return confirm('Are you sure you want to delete this joke?');"
        >
          <button type="submit" class="delete-button">Delete</button>
        </form>
      </div>
      {% endif %}
    </div>
    {% endfor %} {% else %}
    <p>{{ username }} hasn't posted any jokes yet.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
